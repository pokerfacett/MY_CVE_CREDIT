## Background
Allwinner R818 SoC is made for smart speakers with a screen which is a processor for use in Android-based
It integrates quad-core 64-bit CortexTM-A53 CPU and Imagination PowerVR GE8300 GPU to ensure response rapidity and
running smoothness for daily application, such as on-line video, web browsing, and so on

## Description
There is a NULL Pointer Reference in the syscall open_exec. An third-app could run a evil elf file to cause system crash

## Affect Versions
Soc: Allwinner R818 
System: R818 Android Q 
SDK Version: V1.0 

## POC
The problem appears in the processing of the exec system call:

![image](https://user-images.githubusercontent.com/13774458/129024578-af1032f4-1c09-48f4-b1dd-d876fafeb65b.png)

Here is the part added by allwinner itself. If the application is a 64-bit binary or script, f will be empty

Run directly using a 64-bit binary application

![image](https://user-images.githubusercontent.com/13774458/129024642-97bde6c4-1e7d-4d3d-b630-9792a4273678.png)


The system will hang and cause the following crash:

![image](https://user-images.githubusercontent.com/13774458/129024708-c40d5fa1-c097-4d78-8b90-e2aca60d0ed4.png)

![image](https://user-images.githubusercontent.com/13774458/129024717-9d6732e2-1bd6-409c-95f3-64872abc1d1f.png)

You can see that the call stack did crash to the place where the open_exec system call was made.


## Patch
The patch of Allwinner is as follow:

![image](https://user-images.githubusercontent.com/13774458/129024779-2b7f28b5-17d7-4d66-bb63-163ee5cd85e9.png)


## References
https://www.cnvd.org.cn/flaw/show/CNVD-2021-46927

https://vul.wangan.com/a/CNVD-2021-46927

https://www.allwinnertech.com/index.php?c=product&a=index&id=92
