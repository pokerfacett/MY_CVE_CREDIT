## Background
Allwinner R818 SoC is made for smart speakers with a screen which is a processor for use in Android-based
It integrates quad-core 64-bit CortexTM-A53 CPU and Imagination PowerVR GE8300 GPU to ensure response rapidity and
running smoothness for daily application, such as on-line video, web browsing, and so on

## Description
The Background service is used to manage background applications. Malicious apps can use the interface provided by the service to set the number of applications allowed to run in the background to 0 and add themselves to the whitelist, so that once other applications enter the background, they will be forcibly stopped by the system;

## Affect Versions
Soc: Allwinner R818 
System: R818 Android Q 
SDK Version: V1.0 

## POC

awbms.jar, after decompilation, you can see that none of the interfaces provided by the service has been verified

![image](https://user-images.githubusercontent.com/13774458/129029091-3374de2b-ba26-45c8-9649-2561b770850b.png)

Poc

![image](https://user-images.githubusercontent.com/13774458/129029113-95af4414-595d-4849-8d70-3e9452370d26.png)

After running the poc, start any third-party app, and then click the home button to make the third-party app enter the background, you can see the log, and the third-party app is killed;

![image](https://user-images.githubusercontent.com/13774458/129029148-d060dddd-076d-4ade-b112-5ebe7ab1f194.png)



## Patch
The patch of Allwinner is as follow:

![image](https://user-images.githubusercontent.com/13774458/129029479-cc6e7f84-3ce1-4124-98c3-a606ed387d85.png)


## References
https://www.cnvd.org.cn/flaw/show/CNVD-2021-46928

https://vul.wangan.com/a/CNVD-2021-46928

https://www.allwinnertech.com/index.php?c=product&a=index&id=92
