# Description

Espressif ESP-IDF 2.x, 3.0.x through 3.0.9, 3.1.x through 3.1.7, 3.2.x through 3.2.3, 3.3.x through 3.3.2, and 4.0.x through 4.0.1 has a Buffer Overflow in BluFi provisioning in btc_blufi_recv_handler function in blufi_prf.c. An attacker can send a crafted BluFi protocol Write Attribute command to characteristic 0xFF01. With manipulated packet fields, there is a buffer overflow.

# Reporter

Lewei Qu

# References

https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=cve-2020-16146

https://github.com/espressif/esp-idf

https://www.espressif.com/en/products/socs

https://github.com/espressif/esp-idf/issues/5048
