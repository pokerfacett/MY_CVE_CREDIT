## Background
Allwinner R818 SoC is made for smart speakers with a screen which is a processor for use in Android-based
It integrates quad-core 64-bit CortexTM-A53 CPU and Imagination PowerVR GE8300 GPU to ensure response rapidity and
running smoothness for daily application, such as on-line video, web browsing, and so on

## Description
There is a NULL Pointer Dereference in the media/libcedarc/vdecoder which could cause the media crash

## Affect Versions

Soc: Allwinner R818 

System: R818 Android Q 

SDK Version: V1.0 

## POC
The problem code is as follow:

![image](https://user-images.githubusercontent.com/13774458/129025464-f7848d16-98ef-49e2-8808-c55f88b03e79.png)

Null pointer verification for pDecoder is not performed here. We use vdecoderDemo for audio and video decoding, which can directly trigger the null pointeruf_get will return Null if the pVeIommuBuf->fd is invalid.

vdecoderDemo -i ./null_pointer_poc

The crash log is as follow:

![image](https://user-images.githubusercontent.com/13774458/129025554-62f9ef6d-51e8-49d4-950e-02c45583d3a1.png)

## Patch
The patch of Allwinner is as follow:

![image](https://user-images.githubusercontent.com/13774458/129025574-55e94e5b-3516-4fb1-b5a0-848e12dea541.png)

![image](https://user-images.githubusercontent.com/13774458/129025583-14c925a7-08d1-437e-8861-739b08875600.png)

## Reporter

Lewei Qu and Dongxiang Ke


## References
https://www.cnvd.org.cn/flaw/show/CNVD-2021-49173

https://vul.wangan.com/a/CNVD-2021-49173

https://www.allwinnertech.com/index.php?c=product&a=index&id=92
